<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Covariance and Correlation</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<head>
	<meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-135221736-1"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());

	  gtag('config', 'UA-135221736-1');
	</script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/iframe-resizer/3.5.16/iframeResizer.min.js"></script>
	
	<link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,700" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Lora:400,400i,700,700i" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,200i,300,300i,400,400i,600,600i,700,700i,900,900i" rel="stylesheet">
  <link href="assets/style.css" rel="stylesheet">
  
</head>


  <!---div class="image-descript"> 
		<img class="big_image" src="images/big_image/Log.jpg">
		<div class="image-text">
			<div class="lil-image-text">A Tale of Two Variables:</div>
			<div class="big-image-text"><strong>COVARIANCE & CORRELATION</strong></div>
		</div>
  </div-->
  
  
<div class= "hero-container"> 
   <div class="hero-image"> 
		<div class="hero-image-text">
		  <div class="hero-image-text-little">A tale of two variables:</div>
			<div class="hero-image-text-big">Covariance & correlation</div>
		</div>
  </div>
</div>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"> </a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="00_narrative.html">History of Teacup Giraffes</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Modules
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="01_introToR.html">Intro to R</a>
    </li>
    <li>
      <a href="02_bellCurve.html">Intro to the Normal Distribution</a>
    </li>
    <li>
      <a href="03_mean.html">Mean, Median, Mode</a>
    </li>
    <li>
      <a href="04_variance.html">Spread of the Data</a>
    </li>
    <li>
      <a href="05_correlation.html">Covariance and Correlation</a>
    </li>
    <li>
      <a href="06_standardError.html">Standard Error</a>
    </li>
  </ul>
</li>
<li>
  <a href="aboutTheAuthors.html">About the Authors</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/tinystats/teacups-giraffes-and-statistics">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Covariance and Correlation</h1>

</div>


<div class="obj">
<p><strong>Module learning objectives</strong></p>
<ol style="list-style-type: decimal">
<li>Create a scatterplot using ggplot</li>
<li>Identify the similarities and differences between calculating the variance and covariance</li>
<li>Write a function for the covariance and Pearson’s correlation coefficient</li>
<li>Interpret the meaning behind Pearson’s correlation correlation</li>
<li>Describe the purpose of dividing by the product of the standard deviations when calculating the correlation.</li>
</ol>
</div>
<div id="gathering-data-on-another-variable" class="section level1">
<h1>Gathering data on another variable</h1>
<p>Over the course of your time on the islands, you notice that the teacup giraffes seem to have an affinity for celery, which you have already used to entice so they come close enough for a height measurement. Suprisingly, one of the small ones had eaten so much of it! You decide to quantify how much celery each of the giraffes consumed to see if there is any relationship to height.</p>
<p>You systematically measure the amount of celery eaten and add it to your log of data, which is stored as a data frame called <code>giraffe_data</code>.</p>
<p>We can check out the first entries of the data frame by using the <code>head( )</code> command:</p>
<pre class="r"><code>head(giraffe_data)</code></pre>
<pre><code>##     Heights Celery_Eaten
## 1  7.038865     16.36129
## 2 13.154339     10.72354
## 3  8.086511     17.16798
## 4  8.159990     22.52115
## 5  6.004716     13.77993
## 6  9.455408     16.92304</code></pre>
</div>
<div id="make-a-scatter-plot" class="section level1">
<h1>Make a scatter plot</h1>
<p>It’s difficult to get an idea if there’s any relationship by just looking at the data frame. We learn so much more from creating a plot. Let’s revisit our newly acquired ggplot skills to make a scatter plot.</p>
<p>A lot of the code used <a href="02_bellCurve.html">previously</a> can be re-used for the scatter plot. Two main differences are the following:</p>
<ol style="list-style-type: decimal">
<li><p>Because we now have an additional variable, we need to <strong>assign a <code>y =</code> for the <code>aes( )</code> command within <code>ggplot( )</code></strong>. Create the plot so that <code>Celery_Eaten</code> will be on the y-axis.</p></li>
<li><p><strong>Add (<code>+</code>) a <code>geom_point( )</code></strong> element instead of <code>geom_hist( )</code></p></li>
</ol>
<p>Also, we will add lines to our plot, representing the mean of each variable. Here’s how we’ll do that:</p>
<ol start="3" style="list-style-type: decimal">
<li><strong>Add a horizontal line</strong> by adding (<code>+</code>) a <code>geom_hline( )</code> component. This takes the argument <code>yintercept =</code>, which equals the value for where the horizontal line should cross the y-intercept.
<ul>
<li>Since we want to place this line at the mean of y variable (<span class="math inline">\({\bar{y}}\)</span>), we can use the <code>mean( )</code> function instead of specifying a numeric value directly.</li>
</ul></li>
<li><strong>Add a vertical line</strong> by following the same structure as above but using <code>geom_vline( )</code> and <code>xintercept =</code> instead. This vertical line will represent the mean (<span class="math inline">\({\bar{x}}\)</span>) of the heights.</li>
</ol>
<p>Construct a scatter plot of the data using the window below:</p>
<!---LEARNR EX 1-->
<iframe class="interactive" id="myIframe1" src="https://tinystats.shinyapps.io/05-correlation-ex1/" scrolling="no" frameborder="no">
</iframe>
<!------------->
<p>Great, now you have a scatter plot! But recalling the email from your advisor the last time you plotted data, you decide you’d like to customize the look of the plot the same way you did when you created the ggplot histogram.</p>
<p>Play around with some aesthetics in the window below, and then run the solution to see what we chose.</p>
<!---LEARNR EX 2-->
<iframe class="interactive" id="myIframe2" src="https://tinystats.shinyapps.io/05-correlation-ex2/
" scrolling="no" frameborder="no">
</iframe>
<!------------->
<p>Looking at the scatter plot, there seems to be a relationship between height and celery eaten, but you will need to quantify this more formally to be sure.</p>
</div>
<div id="relationship-between-two-variables" class="section level1">
<h1>Relationship between two variables</h1>
<p>How can the relationship between two variables (and its strength) be quantified? This can be done by assessing how the two variables change together – one such measure is the <strong>covariance</strong>.</p>
<p>The covariance elegantly combines the deviations of observations from two different variables into a single value. This is how it’s done:</p>
<ol style="list-style-type: decimal">
<li>As we did for the variance, we begin by measuring how far each observation lies from its mean. But unlike when we calculated the variance, each observation now includes two variables. We will need to <strong>calculate the observation’s distance from each variable’s mean</strong>. We call each distance the <strong>deviation</strong> scores on x and on y, respectively. Like the variance, the observation can fall above or below the mean, and as a result the corresponding deviation score will have either a positive or negative sign.</li>
</ol>
<p>We observe this below with a subset of 5 points from our scatter plot. Positive deviations are shown in red, negative deviations in blue.</p>
<center>
<img src="images/05_correlation/points.jpg" alt="points" width="650" />
</center>
<p>Why do we use the deviations? Because we want to know whether the x-values and y-values move together with respect to their means or not. For example, when an observation’s deviation on x is above <span class="math inline">\(\bar{x}\)</span>, will its deviation on y also be above <span class="math inline">\(\bar{y}\)</span>? Using this line of thought, we can begin to systematically characterize how “together” the x and y values will change as we go through all observations.</p>
</div>
<div id="crossproduct" class="section level1">
<h1>Crossproduct</h1>
<p>After obtaining the deviation scores, we need to combine them into a single measure. We do not simply combine the deviation scores themselves by adding (please see the <a href="04_variance.html">page about the variance</a> for a discussion of why this is). Instead, we take both deviation scores from the same observation and multiply them together to create a two-dimensional “shape” (analagous to when we multiplied a single deviation score by itself to create a square in the variance calculation).</p>
<p><strong>NOTE:</strong> The resulting value is now on the order of a “squared” term. This will become important later.</p>
<ol start="2" style="list-style-type: decimal">
<li><strong>Multiply the two deviation scores.</strong> This is called the <strong>crossproduct</strong>. The shapes created by the crossproduct will serve as the “squared” terms that we can then use in the next step to sum and summarize the deviations into a single value.</li>
</ol>
<p>The equation is shown below for the <em>sample</em> crossproduct of the deviation scores.</p>
<div style="margin-bottom:50px">

</div>
<span class="math display" id="eq:equation1">\[\begin{equation}
 \tag{1}
 \Large (x_i - \bar{x})(y_i - \bar{y})
 \end{equation}\]</span>
<div style="margin-bottom:50px">

</div>
<p>Let’s explore the attributes of the crossproduct:</p>
<div style="margin-bottom:50px">

</div>
<ul>
<li><p>First, we should note that the <em>overall sign</em> of the crossproduct will depend on whether or not the two x- and y- values from the same observation move in the same directions relative to their means. Look at the annotated plot below. The crossproducts will either create “negative” shapes (shown in blue) or “positive” shapes (in red). A third outcome is that the crossproduct could also be 0 – this will occur when an observation falls on the mean.</p></li>
<li><p>Second, the <strong>magnitude of the crossproduct</strong> will scale with the absolute value of the deviation scores. In other words, the further away both deviation scores are from their means, the larger the area of their shapes will be.</p></li>
</ul>
<center>
<img src="images/05_correlation/points1.jpg" width="650" />
</center>
<p>The animation below shows the “construction” of the crossproducts from the 5 observations we have been following:</p>
<video class="small_vid"  autoplay loop muted playsinline>
<source src="images/05_correlation/lines.webm" type="video/webm">
<source src="images/05_correlation/lines.mp4" type="video/mp4">
</video>
<p><br />
</p>
<ol start="3" style="list-style-type: decimal">
<li><strong>Sum the crossproducts.</strong> The sum of the crossproduct gives us a single number.
<div style="margin-bottom:50px">

</div>
<center>
<img src="images/05_correlation/Shapes%202.png" style="width:90.0%" />
</center>
<div style="margin-bottom:50px">

</div></li>
</ol>
<p>As we add the crossproducts, some of the “negative” and “positive” values of the shapes will cancel each other out. This is okay because this tells us important information about our two variables. If the negative and positive shapes cancel each other out completely, it would mean that there is no relationship. In most cases this will not happen, and the sum of the crossproducts will be positive or negative. In general, the larger the magnitude of the sum of the crossproducts, the more strongly the two variables move together. The equation is shown below.</p>
<div style="margin-bottom:50px">

</div>
<span class="math display" id="eq:equation2">\[\begin{equation}
 \tag{2}
 \Large \sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})
 \end{equation}\]</span>
<div style="margin-bottom:50px">

</div>
</div>
<div id="covariance" class="section level1">
<h1>Covariance</h1>
<ol start="4" style="list-style-type: decimal">
<li>We then <strong>divide the sum of the crossproduct by <span class="math inline">\(n-1\)</span> (or <span class="math inline">\(N\)</span> in the population equation)</strong> so that we have taken into account how many observations contributed to this quantity. (Why <span class="math inline">\(n-1\)</span>? See <a href="04_variance.html">here</a>.) This final number is called the <strong>covariance</strong>, and its value tells us how much our two variables fluctuate together. The higher the absolute value, the stronger the relationship.</li>
</ol>
<p>The equation for the covariance (abbreviated “cov”) of the variables x and y is shown below. As a preference of style, we multiply by <span class="math inline">\(\frac{1}{n-1}\)</span> instead of dividing the entire term by <span class="math inline">\(n-1\)</span>.</p>
<div style="margin-bottom:50px">

</div>
<span class="math display" id="eq:equation3">\[\begin{equation}
 \tag{3}
 \Large cov(x,y) = {\frac{1}{n-1}\sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})}
 \end{equation}\]</span>
<div style="margin-bottom:50px">

</div>
</div>
<div id="problem-of-interpretation" class="section level1">
<h1>Problem of interpretation</h1>
<p>However, the covariance is not an intuitive value. Remember that we have been working with terms that are on the “squared” scale, which is not only difficult to interpret (just like the variance is) but it is also the product of two variables on possibly different scales. How could we interpret a covariance with units of millimeters*grams mean?</p>
<p>Another point to make is that value of the covariance will be vastly different if we had decided to change the units (millimeters vs centimeters, or grams vs kilograms).</p>
<p>As a result, the covariance is not an easy metric to work with or to compare with other covariances. So we need to standardize it!</p>
</div>
<div id="pearson-correlation-coefficient-r" class="section level1">
<h1>Pearson correlation coefficient, <span class="math inline">\(r\)</span></h1>
<p>How do we standardize the covariance?</p>
<p>The solution is to (1) take the standard deviations of each variable, (2) multiply them together, and (3) divide the covariance by this product – the resulting value is called the <strong>Pearson correlation coefficient</strong>. When referring to the population correlation coefficient, the symbol <span class="math inline">\(\rho\)</span> (pronounced “rho”) is used. When referring to the sample correlation coefficient, a lowercase <span class="math inline">\(r\)</span> is used (often called “Pearson’s r”).</p>
<div style="margin-bottom:50px">
<p>Here is the equation for the <strong>population correlation</strong>:</p>
</div>
<span class="math display" id="eq:equation4">\[\begin{equation}
 \tag{4}
 \Large \rho(x,y) = \frac{ \frac{1}{N} \sum_{i=1}^N (x_i - \mu_x)(y_i - \mu_y)}{\sigma_x \sigma_y}
 \end{equation}\]</span>
<div style="margin-bottom:50px">

</div>
<div style="margin-bottom:50px">

</div>
This equation is used for the <strong>sample correlation</strong>:
<span class="math display" id="eq:equation5">\[\begin{equation}
 \tag{5}
 \Large r(x,y) = \frac{ \frac{1}{n-1} \sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})}{s_x s_y}
 \end{equation}\]</span>
<div style="margin-bottom:50px">

</div>
</div>
<div id="what-the-does-correlation-mean" class="section level1">
<h1>What the does correlation mean?</h1>
<p>We can interpret the correlation as a measure of <strong>the strength and direction</strong> of the relationship between two variables. It is a “standardized” version of the covariance.</p>
<ul>
<li>The correlation will always be between -1 and 1. At these extreme values, the two variables have the strongest relationship possible, in which each data point will fall exactly on a line. When the absolute value of the correlation coefficient approaches 0, the observations will be more “scattered”.</li>
<li>The sign of the correlation coefficient indicates the direction of the linear relationship. When <span class="math inline">\(r\)</span>= 0 there is no relationship between the variables. Look at the figure below to see what observations of different <span class="math inline">\(r\)</span> values look like.</li>
</ul>
<center>
<img src="images/05_correlation/diff_corr.png" style="width:90.0%" />
</center>
<p><strong>Your turn</strong></p>
<p>Imagine you’re given a plot like the one below. What would you say it’s correlation value is? Try out your guess for a few plots, and if you need a hint to help you visualize, click <em>Show trend line</em>.</p>
<!--------SHINY1------>
<iframe class="interactive" src="https://tinystats.shinyapps.io/Guess_corr/?showcase=0" scrolling="no" frameborder="no">
</iframe>
</div>
<div id="code-it-up" class="section level1">
<h1>Code it up</h1>
<ul>
<li>In the window below, write your own function to compute the sample covariance of two variables, and call it <code>my_covariance( )</code>.</li>
<li>Then create a second function called <code>my_correlation( )</code> in which you will compute the correlation of two variables. You may incorporate your function <code>my_covariance( )</code> in this step to save yourself some time.</li>
<li>Once you’ve created both functions, use them to compute the covariance and correlation between <code>Heights</code> and <code>Celery_Eaten</code> within the data frame <code>giraffe_data</code>.</li>
<li>Finally, compare your functions’ outputs with the base R functions for covariance, <code>cov( )</code> and <code>cor( )</code>.</li>
</ul>
<p>Remember, you will need to write both functions so that they will take two parameters, one for each variable. The parameters for <code>my_covariance( )</code> have been setup for you.</p>
<!--LEARNR EX 3--->
<iframe class="interactive" id="myIframe3" src="https://tinystats.shinyapps.io/05-correlation-ex3/" scrolling="no" frameborder="no">
</iframe>
<!----------->
<p><br />
</p>
<p>Wow, you can see that there is a negative relationship between giraffe heights and how much celery teacup giraffes eat. Could this be due to celery being a negative calorie vegetable? Are these giraffes onto something?</p>
<center>
<img src="images/05_correlation/Celery.png" style="width:30.0%" />
</center>
</div>
<div id="the-standardizer" class="section level1">
<h1>The Standardizer</h1>
<p>You can take a look at the animation below to see a conceptual summary of how correlation will standarize the covariance, translating it into an easily interpretable metric that will always be bound by -1 and 1.</p>
<!-- # ```{r, fig.show='animate', animation.hook = 'gifski', interval= 0.15, fig.width=10, fig.height=5, echo=FALSE, results="hide", message=FALSE} -->
<!-- #  -->
<!-- # getwd() -->
<!-- #  -->
<!-- # library(jpeg) -->
<!-- # library(gifski) -->
<!-- # frames <- list.files(path="factory/") -->
<!-- #  -->
<!-- # factory <- function(x){ -->
<!-- # img <- readJPEG(paste0("factory/",frames[x]), native=TRUE) -->
<!-- # plot(0:1, 0:1, type="n", ann=FALSE, axes=FALSE) -->
<!-- # rasterImage(img,0,0,1,1) -->
<!-- # } -->
<!-- #  -->
<!-- # lapply(1:175, function(x) factory(x)) -->
<!-- #  -->
<!-- #  -->
<!-- # # gif_file <-  file.path(getwd(), 'factory.gif') -->
<!-- # # save_gif(lapply(1:175, function(x) factory(x)), gif_file= gif_file, progress = TRUE, loop= TRUE, delay= 0.5, width=400, height= 133) -->
<!-- # #  -->
<!-- # # utils::browseURL(gif_file) -->
<!-- #  -->
<!-- # ``` -->
<!--![](images/05_correlation/factory.gif)-->
<video controls disablePictureInPicture controlslist="nodownload nofullscreen noremoteplayback" loop muted playsinline poster="images/05_correlation/factory.png">
<source src="images/05_correlation/factory.webm" type="video/webm">
<source src="images/05_correlation/factory.mp4" type="video/mp4">
</video>
</div>
<div id="why-divide-by-sigma_xsigma_y" class="section level1">
<h1>Why divide by <span class="math inline">\(\sigma_x\sigma_y\)</span>?</h1>
<p>Well it’s complicated, (see <a href="https://www.quora.com/What-is-an-intuitive-explanation-for-why-the-sample-correlation-coefficient-is-equal-to-the-sample-covariance-divided-by-the-standard-deviations-of-x-and-y-multiplied-by-one-another">here</a> and <a href="https://math.stackexchange.com/questions/158449/proving-that-the-magnitude-of-the-sample-correlation-coefficient-is-at-most-1">here</a>) but it builds on the mathematical principle that the covariance of x and y will never exceed the product of the standard deviations of x and y. This means that the maximum correlation value will occur when the absolute value of the covariance and the product of the standard deviations are equal.</p>
<p>If you don’t take our word for it, press play below to see what the relationship between <span class="math inline">\({s}_x{s}_y\)</span> and <span class="math inline">\({cov(x,y)}\)</span> looks like.</p>
<center>
<iframe style="margin: 0;" src="images/05_correlation/cov_vs_sxsy.html" width="720" height="500" scrolling="yes" seamless="seamless" frameBorder="0">
</iframe>
</center>
<p>As you look at the plot above, you may have the following questions:</p>
<ul>
<li><p>Why are there clearly defined boundaries?</p>
<ul>
<li><p>Because at the edges is where the covariance is the greatest value that it can be– it is equal to the product of the standard deviations there.</p></li>
<li><p>The slope is 1 at this boundary.</p></li>
</ul></li>
<li><p>Where in the plot do the strongest correlations end up?</p>
<ul>
<li>On the edges – when the absolute value of the numerator and denominator of the equation are equal– the quotient will = 1 (or negative 1, depending on the sign of the covariance in the numerator).</li>
</ul></li>
</ul>
</div>
<div id="things-to-think-about" class="section level1">
<h1>Things to think about</h1>
<p><strong>Correlation does not capture relationships that are not linear</strong>: If the relationship is not linear, then correlation will not be meaningful. Check out the plot below. There is a clear U-shaped relationship between the two variables, but the correlation coefficient for these data is very close to 0. To meausure non-linear relationships a different metric must be used.</p>
<center>
<img src="images/05_correlation/corr_curve.png" style="width:40.0%" />
</center>
<p><strong>Correlation is not causation</strong>: Just because there is a linear relationship between two variables does not mean we have evidence that one variable causes the other. Even if there really was a cause-and-effect relationship, with correlation we cannot say which variable is the cause and which is the effect. It’s also possible that there exists some other unmeasured variable affecting the linear relationship we observe. And of course, any apparent relationship may be due to nothing more than random chance.</p>
<script>
  iFrameResize({}, ".interactive");
</script>
</div>

<!DOCTYPE html>

<div class="foot">
	<hr> 
	<p style="text-align: center;"> <span style="color: #808080; display: inline-block; width: 33%;"> 	This project was created entirely in RStudio using R Markdown with features making use of DataCamp Light windows and published on GitHub pages. 
 </span></p>
	<p style="text-align: center;">
	</p>
</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
